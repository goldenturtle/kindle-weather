<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="utf-8">
    <title>Kindle Weather Hindi Final</title>
    <style>
        /* RESET & BASICS */
        * { box-sizing: border-box; }
        body {
            margin: 0;
            padding: 0;
            background-color: white;
            color: black;
            width: 758px;  /* Paperwhite Width */
            height: 1024px; /* Paperwhite Height */
            overflow: hidden;
            font-family: "Noto Sans Devanagari", "Lohit Devanagari", "Arial Unicode MS", sans-serif;
            display: flex;
            flex-direction: column;
        }

        /* 1. TOP BAR (Inverted Style) */
        .header {
            background-color: black;
            color: white;
            width: 100%;
            height: 80px; /* Taller for Tithi */
            display: flex;
            flex-direction: column; /* Stack Date & Tithi */
            align-items: center;
            justify-content: center;
            padding: 5px 20px;
        }
        .header-top { width: 100%; display: flex; justify-content: space-between; align-items: center; }
        .city { font-size: 32px; font-weight: 900; text-transform: uppercase; letter-spacing: 1px; }
        .date { font-size: 28px; font-weight: 900; }
        .tithi-row { font-size: 18px; font-weight: 700; color: #ddd; margin-top: 2px; width: 100%; text-align: right; }

        /* 2. HERO SECTION (Temp + Summary) */
        .hero {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            border-bottom: 2px solid black;
            height: 210px;
        }
        .hero-left { width: 45%; }
        .main-temp { font-size: 140px; font-weight: 900; line-height: 1; letter-spacing: -5px; }
        
        .hero-right { width: 55%; padding-left: 10px; display: flex; flex-direction: column; justify-content: center; }
        .main-cond { font-size: 38px; font-weight: 900; margin-bottom: 10px; line-height: 1.1; }
        .summary { font-size: 24px; font-weight: 700; opacity: 0.8; line-height: 1.4; }
        .aqi-badge { 
            display: inline-block; 
            background: black; 
            color: white; 
            padding: 4px 10px; 
            border-radius: 4px; 
            font-size: 18px; 
            font-weight: 900; 
            width: fit-content;
            margin-top: 10px;
        }

        /* 3. HOURLY STRIP */
        .hourly-title {
            font-size: 22px; font-weight: 900; padding: 10px 20px 0; opacity: 0.7; text-transform: uppercase;
        }
        .hourly-container {
            display: flex;
            justify-content: space-between;
            padding: 10px 20px 20px;
            border-bottom: 3px solid black;
        }
        .hour-box {
            width: 23%;
            text-align: center;
            background: #f0f0f0;
            padding: 10px 5px;
            border-radius: 8px;
        }
        .h-time { font-size: 24px; font-weight: 900; margin-bottom: 5px; }
        .h-temp { font-size: 42px; font-weight: 900; line-height: 1.1; }
        .h-cond { font-size: 22px; margin: 5px 0; font-weight: 700; height: 50px; overflow: hidden; display: flex; align-items: center; justify-content: center; line-height: 1.1; }
        .h-rain { font-size: 20px; font-weight: 900; color: #444; }

        /* 4. DETAILS GRID */
        .grid-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            padding: 15px 20px; 
            flex-grow: 1; 
        }
        .detail-box {
            border: 3px solid black;
            border-radius: 12px;
            padding: 8px 15px;
            display: flex;
            flex-direction: column;
            justify-content: space-evenly;
        }
        .d-title { font-size: 22px; font-weight: 900; border-bottom: 2px solid black; padding-bottom: 5px; margin-bottom: 5px; }
        .d-row { display: flex; justify-content: space-between; font-size: 26px; font-weight: 700; margin-bottom: 2px; }

        /* 5. FORECAST */
        .forecast-container {
            padding: 10px 20px;
            border-top: 2px solid black;
        }
        .f-row {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px solid #ccc;
            padding: 6px 0;
            font-size: 26px;
            font-weight: 700;
            align-items: center;
        }
        .f-row:last-child { border-bottom: none; }
        
        /* 6. ASTRO STRIP */
        .astro-strip {
            background: black;
            color: white;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            font-size: 24px;
            font-weight: 900;
            align-items: center;
        }
        .astro-group { display: flex; align-items: center; gap: 15px; }
        .astro-icon { font-size: 30px; margin-right: 5px; }

        /* FOOTER */
        .footer { text-align: center; padding: 5px; font-size: 14px; color: #666; background: #eee;}

    </style>
</head>
<body>

    <div class="header">
        <div class="header-top">
            <div class="city" id="city">MUMBAI</div>
            <div class="date" id="date">--</div>
        </div>
        <div class="tithi-row" id="tithi">‡§ö‡§Ç‡§¶‡•ç‡§∞ ‡§§‡§ø‡§•‡§ø ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...</div>
    </div>

    <div class="hero">
        <div class="hero-left">
            <div class="main-temp" id="temp">--</div>
        </div>
        <div class="hero-right">
            <div class="main-cond" id="cond">--</div>
            <div class="summary" id="summary">...</div>
            <div class="aqi-badge" id="aqi">AQI --</div>
        </div>
    </div>

    <div class="hourly-title">‡§Ö‡§ó‡§≤‡•á 12 ‡§ò‡§Ç‡§ü‡•á</div>
    <div class="hourly-container" id="hourlyStrip">
        </div>

    <div class="grid-container">
        <div class="detail-box">
            <div class="d-title">‡§π‡§µ‡§æ ‡§î‡§∞ ‡§¨‡§æ‡§∞‡§ø‡§∂</div>
            <div class="d-row"><span>‡§π‡§µ‡§æ</span><span id="wind">--</span></div>
            <div class="d-row"><span>‡§ù‡•ã‡§Ç‡§ï‡•á</span><span id="gust">--</span></div>
            <div class="d-row"><span>‡§¨‡§æ‡§∞‡§ø‡§∂</span><span id="rain">--</span></div>
        </div>
        <div class="detail-box">
            <div class="d-title">‡§µ‡§æ‡§§‡§æ‡§µ‡§∞‡§£</div>
            <div class="d-row"><span>‡§Ü‡§∞‡•ç‡§¶‡•ç‡§∞‡§§‡§æ</span><span id="hum">--</span></div>
            <div class="d-row"><span>‡§¶‡•É‡§∂‡•ç‡§Ø‡§§‡§æ</span><span id="vis">--</span></div>
            <div class="d-row"><span>UV</span><span id="uv">--</span></div>
        </div>
    </div>

    <div class="forecast-container" id="forecastRows"></div>

    <div class="astro-strip">
        <div class="astro-group">
            <span class="astro-icon">‚òÄÔ∏è</span>
            <span id="sun-times">--</span>
        </div>
        <div class="astro-group">
            <span class="astro-icon">üåô</span>
            <span id="moon-times">--</span>
        </div>
    </div>

    <div class="footer" id="footerMsg">Updated: --</div>

    <script>
        // === HINDI CONSTANTS ===
        const DAYS_HI = ["‡§∞‡§µ‡§ø‡§µ‡§æ‡§∞", "‡§∏‡•ã‡§Æ‡§µ‡§æ‡§∞", "‡§Æ‡§Ç‡§ó‡§≤‡§µ‡§æ‡§∞", "‡§¨‡•Å‡§ß‡§µ‡§æ‡§∞", "‡§ó‡•Å‡§∞‡•Å‡§µ‡§æ‡§∞", "‡§∂‡•Å‡§ï‡•ç‡§∞‡§µ‡§æ‡§∞", "‡§∂‡§®‡§ø‡§µ‡§æ‡§∞"];
        const MONTHS_HI = ["‡§ú‡§®‡§µ‡§∞‡•Ä", "‡§´‡§∞‡§µ‡§∞‡•Ä", "‡§Æ‡§æ‡§∞‡•ç‡§ö", "‡§Ö‡§™‡•ç‡§∞‡•à‡§≤", "‡§Æ‡§à", "‡§ú‡•Ç‡§®", "‡§ú‡•Å‡§≤‡§æ‡§à", "‡§Ö‡§ó‡§∏‡•ç‡§§", "‡§∏‡§ø‡§§‡§Ç‡§¨‡§∞", "‡§Ö‡§ï‡•ç‡§ü‡•Ç‡§¨‡§∞", "‡§®‡§µ‡§Ç‡§¨‡§∞", "‡§¶‡§ø‡§∏‡§Ç‡§¨‡§∞"];

        // === WEATHER CONDITION TRANSLATIONS (English -> Hindi) ===
        const WEATHER_MAP = {
            "Sunny": "‡§ß‡•Ç‡§™",
            "Clear": "‡§∏‡§æ‡§´‡§º",
            "Partly cloudy": "‡§Ü‡§Ç‡§∂‡§ø‡§ï ‡§¨‡§æ‡§¶‡§≤",
            "Cloudy": "‡§¨‡§æ‡§¶‡§≤",
            "Overcast": "‡§ò‡§®‡•á ‡§¨‡§æ‡§¶‡§≤",
            "Mist": "‡§ï‡•ã‡§π‡§∞‡§æ",
            "Patchy rain possible": "‡§π‡§≤‡•ç‡§ï‡•Ä ‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§∏‡§Ç‡§≠‡§µ",
            "Patchy snow possible": "‡§π‡§≤‡•ç‡§ï‡•Ä ‡§¨‡§∞‡•ç‡§´‡§¨‡§æ‡§∞‡•Ä ‡§∏‡§Ç‡§≠‡§µ",
            "Patchy sleet possible": "‡§ì‡§≤‡•á ‡§∏‡§Ç‡§≠‡§µ",
            "Patchy freezing drizzle possible": "‡§¨‡§∞‡•ç‡§´‡•Ä‡§≤‡•Ä ‡§¨‡•Ç‡§Ç‡§¶‡§æ‡§¨‡§æ‡§Ç‡§¶‡•Ä ‡§∏‡§Ç‡§≠‡§µ",
            "Thundery outbreaks possible": "‡§§‡•Ç‡§´‡§æ‡§® ‡§∏‡§Ç‡§≠‡§µ",
            "Blowing snow": "‡§¨‡§∞‡•ç‡§´‡§¨‡§æ‡§∞‡•Ä",
            "Blizzard": "‡§¨‡§∞‡•ç‡§´‡•Ä‡§≤‡§æ ‡§§‡•Ç‡§´‡§æ‡§®",
            "Fog": "‡§ï‡•ã‡§π‡§∞‡§æ",
            "Freezing fog": "‡§ú‡§Æ‡§æ ‡§¶‡•á‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§ï‡•ã‡§π‡§∞‡§æ",
            "Patchy light drizzle": "‡§π‡§≤‡•ç‡§ï‡•Ä ‡§¨‡•Ç‡§Ç‡§¶‡§æ‡§¨‡§æ‡§Ç‡§¶‡•Ä",
            "Light drizzle": "‡§¨‡•Ç‡§Ç‡§¶‡§æ‡§¨‡§æ‡§Ç‡§¶‡•Ä",
            "Freezing drizzle": "‡§¨‡§∞‡•ç‡§´‡•Ä‡§≤‡•Ä ‡§¨‡•Ç‡§Ç‡§¶‡§æ‡§¨‡§æ‡§Ç‡§¶‡•Ä",
            "Heavy freezing drizzle": "‡§≠‡§æ‡§∞‡•Ä ‡§¨‡§∞‡•ç‡§´‡•Ä‡§≤‡•Ä ‡§¨‡•Ç‡§Ç‡§¶‡§æ‡§¨‡§æ‡§Ç‡§¶‡•Ä",
            "Patchy light rain": "‡§π‡§≤‡•ç‡§ï‡•Ä ‡§¨‡§æ‡§∞‡§ø‡§∂",
            "Light rain": "‡§π‡§≤‡•ç‡§ï‡•Ä ‡§¨‡§æ‡§∞‡§ø‡§∂",
            "Moderate rain at times": "‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡§¨‡§æ‡§∞‡§ø‡§∂",
            "Moderate rain": "‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡§¨‡§æ‡§∞‡§ø‡§∂",
            "Heavy rain at times": "‡§≠‡§æ‡§∞‡•Ä ‡§¨‡§æ‡§∞‡§ø‡§∂",
            "Heavy rain": "‡§≠‡§æ‡§∞‡•Ä ‡§¨‡§æ‡§∞‡§ø‡§∂",
            "Light freezing rain": "‡§π‡§≤‡•ç‡§ï‡•Ä ‡§¨‡§∞‡•ç‡§´‡•Ä‡§≤‡•Ä ‡§¨‡§æ‡§∞‡§ø‡§∂",
            "Moderate or heavy freezing rain": "‡§≠‡§æ‡§∞‡•Ä ‡§¨‡§∞‡•ç‡§´‡•Ä‡§≤‡•Ä ‡§¨‡§æ‡§∞‡§ø‡§∂",
            "Light sleet": "‡§π‡§≤‡•ç‡§ï‡•Ä ‡§ì‡§≤‡§æ‡§µ‡•É‡§∑‡•ç‡§ü‡§ø",
            "Moderate or heavy sleet": "‡§≠‡§æ‡§∞‡•Ä ‡§ì‡§≤‡§æ‡§µ‡•É‡§∑‡•ç‡§ü‡§ø",
            "Patchy light snow": "‡§π‡§≤‡•ç‡§ï‡•Ä ‡§¨‡§∞‡•ç‡§´‡§¨‡§æ‡§∞‡•Ä",
            "Light snow": "‡§π‡§≤‡•ç‡§ï‡•Ä ‡§¨‡§∞‡•ç‡§´‡§¨‡§æ‡§∞‡•Ä",
            "Patchy moderate snow": "‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡§¨‡§∞‡•ç‡§´‡§¨‡§æ‡§∞‡•Ä",
            "Moderate snow": "‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡§¨‡§∞‡•ç‡§´‡§¨‡§æ‡§∞‡•Ä",
            "Patchy heavy snow": "‡§≠‡§æ‡§∞‡•Ä ‡§¨‡§∞‡•ç‡§´‡§¨‡§æ‡§∞‡•Ä",
            "Heavy snow": "‡§≠‡§æ‡§∞‡•Ä ‡§¨‡§∞‡•ç‡§´‡§¨‡§æ‡§∞‡•Ä",
            "Ice pellets": "‡§¨‡§∞‡•ç‡§´ ‡§ï‡•á ‡§ó‡•ã‡§≤‡•á",
            "Light rain shower": "‡§π‡§≤‡•ç‡§ï‡•Ä ‡§¨‡•å‡§õ‡§æ‡§∞‡•á‡§Ç",
            "Moderate or heavy rain shower": "‡§≠‡§æ‡§∞‡•Ä ‡§¨‡•å‡§õ‡§æ‡§∞‡•á‡§Ç",
            "Torrential rain shower": "‡§Æ‡•Ç‡§∏‡§≤‡§æ‡§ß‡§æ‡§∞ ‡§¨‡§æ‡§∞‡§ø‡§∂",
            "Light sleet showers": "‡§ì‡§≤‡•á ‡§ï‡•Ä ‡§¨‡•å‡§õ‡§æ‡§∞‡•á‡§Ç",
            "Moderate or heavy sleet showers": "‡§≠‡§æ‡§∞‡•Ä ‡§ì‡§≤‡•á",
            "Light snow showers": "‡§¨‡§∞‡•ç‡§´ ‡§ï‡•Ä ‡§¨‡•å‡§õ‡§æ‡§∞‡•á‡§Ç",
            "Moderate or heavy snow showers": "‡§≠‡§æ‡§∞‡•Ä ‡§¨‡§∞‡•ç‡§´‡§¨‡§æ‡§∞‡•Ä",
            "Light showers of ice pellets": "‡§¨‡§∞‡•ç‡§´ ‡§ï‡•á ‡§ó‡•ã‡§≤‡•ã‡§Ç ‡§ï‡•Ä ‡§¨‡•å‡§õ‡§æ‡§∞",
            "Moderate or heavy showers of ice pellets": "‡§≠‡§æ‡§∞‡•Ä ‡§¨‡§∞‡•ç‡§´ ‡§ï‡•á ‡§ó‡•ã‡§≤‡•á",
            "Patchy light rain with thunder": "‡§ó‡§∞‡§ú ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡§æ‡§∞‡§ø‡§∂",
            "Moderate or heavy rain with thunder": "‡§ó‡§∞‡§ú-‡§ö‡§Æ‡§ï ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡§æ‡§∞‡§ø‡§∂",
            "Patchy light snow with thunder": "‡§ó‡§∞‡§ú ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡§∞‡•ç‡§´",
            "Moderate or heavy snow with thunder": "‡§ó‡§∞‡§ú-‡§ö‡§Æ‡§ï ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡§∞‡•ç‡§´",
            "Smoke": "‡§ß‡•Å‡§Ü‡§Ç",
            "Haze": "‡§ß‡•Å‡§Ç‡§ß",
            "Dust": "‡§ß‡•Ç‡§≤",
            "Sand": "‡§∞‡•á‡§§",
            "Ash": "‡§∞‡§æ‡§ñ",
            "Squall": "‡§Ü‡§Ç‡§ß‡•Ä",
            "Tornado": "‡§¨‡§µ‡§Ç‡§°‡§∞"
        };

        // Helper to translate weather text
        function translateWeather(text) {
            if (!text) return "";
            return WEATHER_MAP[text.trim()] || text; // Returns original English if no translation found
        }

        function formatDateHindi(dateStr) {
            const d = new Date(dateStr);
            return `${DAYS_HI[d.getDay()]}, ${d.getDate()} ${MONTHS_HI[d.getMonth()]}`;
        }

        // === TITHI CALCULATION (Simplified Logic) ===
        // This calculates the approximate Tithi based on Moon Phase age (0-29.5 days)
        function getTithi(dateStr) {
            const date = new Date(dateStr);
            const knownNewMoon = new Date('2000-01-06T18:14:00Z'); // Reference New Moon
            const lunation = 29.53058867; // Length of lunar month in days
            
            const diffTime = date.getTime() - knownNewMoon.getTime();
            const diffDays = diffTime / (1000 * 60 * 60 * 24);
            const moonAge = diffDays % lunation;
            
            // Each Tithi is 12 degrees or approx 0.98 days
            // There are 30 Tithis in a lunar month (15 Shukla + 15 Krishna)
            const tithiIndex = Math.floor((moonAge / lunation) * 30) + 1;
            
            let paksha = "";
            let tithiName = "";
            let icon = "";

            const tithiNames = [
                "‡§™‡•ç‡§∞‡§§‡§ø‡§™‡§¶‡§æ", "‡§¶‡•ç‡§µ‡§ø‡§§‡•Ä‡§Ø‡§æ", "‡§§‡•É‡§§‡•Ä‡§Ø‡§æ", "‡§ö‡§§‡•Å‡§∞‡•ç‡§•‡•Ä", "‡§™‡§Ç‡§ö‡§Æ‡•Ä", 
                "‡§∑‡§∑‡•ç‡§†‡•Ä", "‡§∏‡§™‡•ç‡§§‡§Æ‡•Ä", "‡§Ö‡§∑‡•ç‡§ü‡§Æ‡•Ä", "‡§®‡§µ‡§Æ‡•Ä", "‡§¶‡§∂‡§Æ‡•Ä", 
                "‡§è‡§ï‡§æ‡§¶‡§∂‡•Ä", "‡§¶‡•ç‡§µ‡§æ‡§¶‡§∂‡•Ä", "‡§§‡•ç‡§∞‡§Ø‡•ã‡§¶‡§∂‡•Ä", "‡§ö‡§§‡•Å‡§∞‡•ç‡§¶‡§∂‡•Ä", "‡§™‡•Ç‡§∞‡•ç‡§£‡§ø‡§Æ‡§æ/‡§Ö‡§Æ‡§æ‡§µ‡§∏‡•ç‡§Ø‡§æ"
            ];

            if (tithiIndex <= 15) {
                paksha = "‡§∂‡•Å‡§ï‡•ç‡§≤ ‡§™‡§ï‡•ç‡§∑";
                tithiName = tithiNames[tithiIndex - 1];
                icon = "üåï"; // Waxing
                if (tithiIndex === 15) tithiName = "‡§™‡•Ç‡§∞‡•ç‡§£‡§ø‡§Æ‡§æ";
            } else {
                paksha = "‡§ï‡•É‡§∑‡•ç‡§£ ‡§™‡§ï‡•ç‡§∑";
                tithiName = tithiNames[(tithiIndex - 16)];
                icon = "üåë"; // Waning
                if (tithiIndex === 30 || tithiIndex === 0) tithiName = "‡§Ö‡§Æ‡§æ‡§µ‡§∏‡•ç‡§Ø‡§æ";
            }

            return `${icon} ${paksha} ${tithiName}`;
        }

        function render(data) {
            if(!data || !data.current) return;
            const cur = data.current;
            const loc = data.location;
            const f = data.forecast.forecastday;
            const today = f[0];

            // 1. Header
            document.getElementById("city").innerText = loc.name;
            document.getElementById("date").innerText = formatDateHindi(loc.localtime);
            
            // Calculate and display Tithi
            document.getElementById("tithi").innerText = getTithi(loc.localtime);

            // 2. Hero
            document.getElementById("temp").innerText = Math.round(cur.temp_c) + "¬∞";
            document.getElementById("cond").innerText = translateWeather(cur.condition.text);
            
            const high = Math.round(today.day.maxtemp_c);
            const low = Math.round(today.day.mintemp_c);
            const rainChance = today.day.daily_chance_of_rain;
            
            // Translate summary manually
            document.getElementById("summary").innerText = `‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ ${high}¬∞ ‚Ä¢ ‡§®‡•ç‡§Ø‡•Ç‡§®‡§§‡§Æ ${low}¬∞\n‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ: ${rainChance}%`;
            
            const aqiVal = (cur.air_quality && cur.air_quality["us-epa-index"]) || "--";
            document.getElementById("aqi").innerText = "AQI " + aqiVal;

            // 3. Hourly Logic
            let allHours = [...today.hour, ...f[1].hour];
            const currentEpoch = cur.last_updated_epoch;
            let currentIndex = allHours.findIndex(h => h.time_epoch > currentEpoch);
            if(currentIndex === -1) currentIndex = 0;

            let hourlyHTML = "";
            [3, 6, 9, 12].forEach(offset => {
                const h = allHours[currentIndex + offset];
                if(h) {
                    const dateObj = new Date(h.time);
                    let hrs = dateObj.getHours();
                    const ampm = hrs >= 12 ? 'PM' : 'AM';
                    hrs = hrs % 12; 
                    hrs = hrs ? hrs : 12;
                    
                    hourlyHTML += `
                    <div class="hour-box">
                        <div class="h-time">${hrs} ${ampm}</div>
                        <div class="h-temp">${Math.round(h.temp_c)}¬∞</div>
                        <div class="h-cond">${translateWeather(h.condition.text)}</div>
                        <div class="h-rain">üíß ${h.chance_of_rain}%</div>
                    </div>`;
                }
            });
            document.getElementById("hourlyStrip").innerHTML = hourlyHTML;

            // 4. Details
            document.getElementById("wind").innerText = cur.wind_kph + " km";
            document.getElementById("gust").innerText = cur.gust_kph + " km";
            document.getElementById("rain").innerText = (cur.precip_mm || 0) + " mm";
            document.getElementById("hum").innerText = cur.humidity + "%";
            document.getElementById("vis").innerText = cur.vis_km + " km";
            document.getElementById("uv").innerText = cur.uv;

            // 5. Forecast List
            let forecastHTML = "";
            for(let i=1; i<=2; i++) {
                const day = f[i];
                const dName = DAYS_HI[new Date(day.date).getDay()];
                forecastHTML += `
                <div class="f-row">
                    <div style="width:25%">${dName}</div>
                    <div style="width:35%">${translateWeather(day.day.condition.text)}</div>
                    <div style="width:40%; text-align:right;">
                        ‚¨Ü${Math.round(day.day.maxtemp_c)}¬∞ ‚¨á${Math.round(day.day.mintemp_c)}¬∞
                    </div>
                </div>`;
            }
            document.getElementById("forecastRows").innerHTML = forecastHTML;

            // 6. Astro Strip
            document.getElementById("sun-times").innerText = `${today.astro.sunrise} - ${today.astro.sunset}`;
            document.getElementById("moon-times").innerText = `${today.astro.moonrise} - ${today.astro.moonset}`;

            document.getElementById("footerMsg").innerText = "Updated: " + loc.localtime.split(" ")[1];
        }

        // Init
        document.addEventListener("DOMContentLoaded", () => {
            if (window.injectedData) {
                render(window.injectedData);
            }
        });
    </script>
</body>
</html>
