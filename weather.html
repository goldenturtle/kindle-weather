<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="utf-8">
    <title>Kindle Weather Hindi Final</title>
    <style>
        /* RESET & BASICS */
        * { box-sizing: border-box; }
        body {
            margin: 0;
            padding: 0;
            background-color: white;
            color: black;
            width: 758px;  /* Paperwhite Width */
            height: 1024px; /* Paperwhite Height */
            overflow: hidden;
            font-family: "Noto Sans Devanagari", "Lohit Devanagari", "Arial Unicode MS", sans-serif;
            display: flex;
            flex-direction: column;
        }

        /* 1. TOP BAR (Inverted Style) */
        .header {
            background-color: black;
            color: white;
            width: 100%;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
        }
        .city { font-size: 32px; font-weight: 900; text-transform: uppercase; letter-spacing: 1px; }
        .date { font-size: 28px; font-weight: 900; }

        /* 2. HERO SECTION (Temp + Summary) */
        .hero {
            display: flex;
            align-items: center;
            padding: 20px;
            border-bottom: 2px solid black;
            height: 220px;
        }
        .hero-left { width: 45%; }
        .main-temp { font-size: 140px; font-weight: 900; line-height: 1; letter-spacing: -5px; }
        
        .hero-right { width: 55%; padding-left: 10px; display: flex; flex-direction: column; justify-content: center; }
        .main-cond { font-size: 36px; font-weight: 900; margin-bottom: 10px; line-height: 1.1; }
        .summary { font-size: 22px; font-weight: 700; opacity: 0.8; line-height: 1.4; }
        .aqi-badge { 
            display: inline-block; 
            background: black; 
            color: white; 
            padding: 4px 10px; 
            border-radius: 4px; 
            font-size: 16px; 
            font-weight: 900; 
            width: fit-content;
            margin-top: 10px;
        }

        /* 3. HOURLY STRIP (The "Empty Space" Filler) */
        .hourly-title {
            font-size: 18px; font-weight: 900; padding: 10px 20px 0; opacity: 0.6; text-transform: uppercase;
        }
        .hourly-container {
            display: flex;
            justify-content: space-between;
            padding: 10px 20px 20px;
            border-bottom: 2px solid black;
        }
        .hour-box {
            width: 23%;
            text-align: center;
            background: #f0f0f0; /* Light gray for contrast */
            padding: 10px 5px;
            border-radius: 8px;
        }
        .h-time { font-size: 18px; font-weight: 900; margin-bottom: 5px; }
        .h-temp { font-size: 32px; font-weight: 900; }
        .h-cond { font-size: 16px; margin: 5px 0; font-weight: 700; height: 40px; overflow: hidden; display: flex; align-items: center; justify-content: center; line-height: 1.1; }
        .h-rain { font-size: 16px; font-weight: 900; color: #444; }

        /* 4. DETAILS GRID (2x2) */
        .grid-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            padding: 20px;
            flex-grow: 1; /* Pushes content to fill space */
        }
        .detail-box {
            border: 3px solid black;
            border-radius: 12px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .d-title { font-size: 18px; font-weight: 900; border-bottom: 2px solid black; padding-bottom: 5px; margin-bottom: 5px; }
        .d-row { display: flex; justify-content: space-between; font-size: 20px; font-weight: 700; margin-bottom: 5px; }

        /* 5. ASTRO STRIP (Bottom) */
        .astro-strip {
            background: black;
            color: white;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            font-size: 18px;
            font-weight: 900;
        }

        /* 6. FORECAST (Bottom) */
        .forecast-container {
            padding: 15px 20px;
        }
        .f-row {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px solid #ccc;
            padding: 8px 0;
            font-size: 24px;
            font-weight: 700;
            align-items: center;
        }
        .f-row:last-child { border-bottom: none; }
        
        /* FOOTER */
        .footer { text-align: center; padding: 5px; font-size: 14px; color: #666; }

    </style>
</head>
<body>

    <div class="header">
        <div class="city" id="city">MUMBAI</div>
        <div class="date" id="date">--</div>
    </div>

    <div class="hero">
        <div class="hero-left">
            <div class="main-temp" id="temp">--</div>
        </div>
        <div class="hero-right">
            <div class="main-cond" id="cond">--</div>
            <div class="summary" id="summary">‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>
            <div class="aqi-badge" id="aqi">AQI --</div>
        </div>
    </div>

    <div class="hourly-title">‡§Ö‡§ó‡§≤‡•á 12 ‡§ò‡§Ç‡§ü‡•á</div>
    <div class="hourly-container" id="hourlyStrip">
        </div>

    <div class="grid-container">
        <div class="detail-box">
            <div class="d-title">‡§π‡§µ‡§æ ‡§î‡§∞ ‡§¨‡§æ‡§∞‡§ø‡§∂</div>
            <div class="d-row"><span>‡§π‡§µ‡§æ</span><span id="wind">--</span></div>
            <div class="d-row"><span>‡§ù‡•ã‡§Ç‡§ï‡•á</span><span id="gust">--</span></div>
            <div class="d-row"><span>‡§¨‡§æ‡§∞‡§ø‡§∂</span><span id="rain">--</span></div>
        </div>
        <div class="detail-box">
            <div class="d-title">‡§µ‡§æ‡§§‡§æ‡§µ‡§∞‡§£</div>
            <div class="d-row"><span>‡§Ü‡§∞‡•ç‡§¶‡•ç‡§∞‡§§‡§æ</span><span id="hum">--</span></div>
            <div class="d-row"><span>‡§¶‡•É‡§∂‡•ç‡§Ø‡§§‡§æ</span><span id="vis">--</span></div>
            <div class="d-row"><span>UV</span><span id="uv">--</span></div>
        </div>
    </div>

    <div class="forecast-container" id="forecastRows">
        </div>

    <div class="astro-strip">
        <span id="sunrise">‚òÄÔ∏è --</span>
        <span id="sunset">üåë --</span>
        <span id="moon">üåô --</span>
    </div>

    <div class="footer" id="footerMsg">Updated: --</div>

    <script>
        // === HINDI HELPERS ===
        const DAYS_HI = ["‡§∞‡§µ‡§ø", "‡§∏‡•ã‡§Æ", "‡§Æ‡§Ç‡§ó‡§≤", "‡§¨‡•Å‡§ß", "‡§ó‡•Å‡§∞‡•Å", "‡§∂‡•Å‡§ï‡•ç‡§∞", "‡§∂‡§®‡§ø"];
        const MONTHS_HI = ["‡§ú‡§®", "‡§´‡§∞", "‡§Æ‡§æ‡§∞‡•ç‡§ö", "‡§Ö‡§™‡•ç‡§∞‡•á‡§≤", "‡§Æ‡§à", "‡§ú‡•Ç‡§®", "‡§ú‡•Å‡§≤‡§æ‡§à", "‡§Ö‡§ó‡§∏‡•ç‡§§", "‡§∏‡§ø‡§§", "‡§Ö‡§ï‡•ç‡§§‡•Ç", "‡§®‡§µ", "‡§¶‡§ø‡§∏"];

        function formatDateHindi(dateStr) {
            const d = new Date(dateStr);
            return `${DAYS_HI[d.getDay()]}, ${d.getDate()} ${MONTHS_HI[d.getMonth()]}`;
        }

        function render(data) {
            if(!data || !data.current) return;
            const cur = data.current;
            const loc = data.location;
            const f = data.forecast.forecastday;
            const today = f[0];

            // 1. Header
            document.getElementById("city").innerText = loc.name;
            // Use local time from API to set the correct date
            document.getElementById("date").innerText = formatDateHindi(loc.localtime);

            // 2. Hero
            document.getElementById("temp").innerText = Math.round(cur.temp_c) + "¬∞";
            document.getElementById("cond").innerText = cur.condition.text;
            
            // Construct Summary Sentence: "High 32 / Low 24. Rain 10%"
            const high = Math.round(today.day.maxtemp_c);
            const low = Math.round(today.day.mintemp_c);
            const rainChance = today.day.daily_chance_of_rain;
            document.getElementById("summary").innerText = `‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ ${high}¬∞ ‚Ä¢ ‡§®‡•ç‡§Ø‡•Ç‡§®‡§§‡§Æ ${low}¬∞\n‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ: ${rainChance}%`;
            
            const aqiVal = (cur.air_quality && cur.air_quality["us-epa-index"]) || "--";
            document.getElementById("aqi").innerText = "AQI " + aqiVal;

            // 3. Hourly Logic (Smart Rollover)
            // We combine today's hours and tomorrow's hours into one long list
            let allHours = [...today.hour, ...f[1].hour];
            // Find current hour index based on API 'last_updated_epoch'
            const currentEpoch = cur.last_updated_epoch;
            let currentIndex = allHours.findIndex(h => h.time_epoch > currentEpoch);
            if(currentIndex === -1) currentIndex = 0;

            let hourlyHTML = "";
            // Pick +3, +6, +9, +12 hours from now
            [3, 6, 9, 12].forEach(offset => {
                const h = allHours[currentIndex + offset];
                if(h) {
                    const dateObj = new Date(h.time);
                    // Format time: 2 PM or 14:00
                    let hrs = dateObj.getHours();
                    const ampm = hrs >= 12 ? 'PM' : 'AM';
                    hrs = hrs % 12; 
                    hrs = hrs ? hrs : 12; // the hour '0' should be '12'
                    
                    hourlyHTML += `
                    <div class="hour-box">
                        <div class="h-time">${hrs} ${ampm}</div>
                        <div class="h-temp">${Math.round(h.temp_c)}¬∞</div>
                        <div class="h-cond">${h.condition.text}</div>
                        <div class="h-rain">üíß ${h.chance_of_rain}%</div>
                    </div>`;
                }
            });
            document.getElementById("hourlyStrip").innerHTML = hourlyHTML;

            // 4. Details
            document.getElementById("wind").innerText = cur.wind_kph + " km";
            document.getElementById("gust").innerText = cur.gust_kph + " km";
            document.getElementById("rain").innerText = (cur.precip_mm || 0) + " mm";
            document.getElementById("hum").innerText = cur.humidity + "%";
            document.getElementById("vis").innerText = cur.vis_km + " km";
            document.getElementById("uv").innerText = cur.uv;

            // 5. Forecast List
            let forecastHTML = "";
            // Show Tomorrow and Day After
            for(let i=1; i<=2; i++) {
                const day = f[i];
                const dName = DAYS_HI[new Date(day.date).getDay()];
                forecastHTML += `
                <div class="f-row">
                    <div style="width:20%">${dName}</div>
                    <div style="width:40%">${day.day.condition.text}</div>
                    <div style="width:40%; text-align:right;">
                        ‚¨Ü${Math.round(day.day.maxtemp_c)}¬∞ ‚¨á${Math.round(day.day.mintemp_c)}¬∞
                    </div>
                </div>`;
            }
            document.getElementById("forecastRows").innerHTML = forecastHTML;

            // 6. Astro Strip
            document.getElementById("sunrise").innerText = "‡§â‡§¶‡§Ø " + today.astro.sunrise;
            document.getElementById("sunset").innerText = "‡§Ö‡§∏‡•ç‡§§ " + today.astro.sunset;
            document.getElementById("moon").innerText = today.astro.moon_phase; // Usually comes in English, can map if needed

            document.getElementById("footerMsg").innerText = "Updated: " + loc.localtime.split(" ")[1];
        }

        // Init
        document.addEventListener("DOMContentLoaded", () => {
            if (window.injectedData) {
                render(window.injectedData);
            } else {
                // Debug mode for PC testing
                document.getElementById("summary").innerText = "Waiting for data...";
            }
        });
    </script>
</body>
</html>
